<article>
  <h3 class="article-title">MapKnitter Annotations: First Live Release</h3>
  <div class="article-info">
    <time class="article-date">September 1, 2014</time>
    <div class="article-source">
      Originally published on 
      <a href="http://publiclab.org/profile/justinmanley">Public Lab</a>
    </div>
  </div>
  <div class="article-body"><p><img src='http://i.publiclab.org/system/images/photos/000/006/541/medium/mapknitter-3.png'/><br /> ### First Live Release! ###</p>
<p>The first pre-beta of the new MapKnitter interface is live!  Try it out at <a href="http://test.publiclab.org:3000/">test.publiclab.org:3000</a>.</p>
<p><br /></p>
<div class="text-center"><a class="btn btn-primary btn-large" href="http://test.publiclab.org:3000/">Try the new MapKnitter</a></div>

<p><br /></p>
<p>Please do note that this is an early release and that the following features, among others, have not yet been implemented.</p>
<ul>
<li>map deletion</li>
<li>anonymous map creation and editing</li>
<li>map export</li>
</ul>
<p>In addition, only those pages which are essential to creating and viewing new maps have been refactored using the new interface.</p>
<p><a href="http://i.publiclab.org/system/images/photos/000/006/542/original/mapknitter-1.png"><img src="http://i.publiclab.org/system/images/photos/000/006/542/medium/mapknitter-1.png" alt="mapknitter-1.png"/></a></p>
<p><a href="http://i.publiclab.org/system/images/photos/000/006/543/original/mapknitter-3.png"><img src="http://i.publiclab.org/system/images/photos/000/006/543/medium/mapknitter-3.png" alt="mapknitter-3.png"/></a></p>
<h3 id="background">Background</h3>
<p>I am working to add rich annotation functionality to MapKnitter as part of Google Summer of Code (read about my project here: <a href="http://publiclab.org/notes/justinmanley/03-18-2014/mapknitter-annotations-using-fabric-js-gsoc-2014-proposal">http://publiclab.org/notes/justinmanley/03-18-2014/mapknitter-annotations-using-fabric-js-gsoc-2014-proposal</a>).</p>
<p>The goal of this research note is to provide an update to the community on my progress with refactoring the MapKnitter interface.</p>
<p>You can check out our previous discussion of this interface refactoring in my previous research notes:</p>
<p><a href="http://publiclab.org/notes/justinmanley/08-06-2014/mapknitter-annotations-interface-refactoring">August 6, 2014 - MapKnitter Annotations: Interface Refactoring</a> </p>
<p><a href="http://publiclab.org/notes/justinmanley/08-19-2014/mapknitter-annotations-interface-refactoring-underway">August 19, 2014 - MapKnitter Annotations: Interface Refactoring Underway</a></p>
<h3 id="progress">Progress</h3>
<p>Since my last research note, I've:</p>
<ul>
<li>Refactored some of the code handling warpables (uploaded images)</li>
<li>Integrated @xvidun's file upload interface (based on <a href="https://github.com/blueimp/jQuery-File-Upload">jQuery-File-Upload</a>).</li>
<li>Enabled <code>Leaflet.Illustrate</code> and <code>Leaflet.Draw</code> in map viewing mode.</li>
<li>Enabled warpable drag-and-drop from the sidebar onto the map.</li>
</ul>
<p>I haven't yet been able to integrate @xvidun's autoplacement features yet because those depend on Cartagen (@xvidun's autoplacement code calls <code>new_image</code> and <code>new_image_GPS</code> from Cartagen).  Unfortunately, the <code>Element.hide()</code> method in Cartagen breaks Bootstrap dropdown menus (presumably because it conflicts with jQuery's <code>hide()</code> method, so it doesn't seem to be a sustainable in the long-term.</p>
<h3 id="up-next">Up Next</h3>
<p>I've spent a lot of time over the past month doing a general overhaul of the MapKnitter editing interface.  Now, I'm going to return to my own project - MapKnitter annotations.  I'm going to work over the next few weeks on integrating the work that I've done on <code>Leaflet.Illustrate</code> into the new Leaflet-based MapKnitter interface.  This will involve:</p>
<ul>
<li>Defining <code>toGeoJSON</code> for <code>Leaflet.Illustrate</code> annotations, deciding how <code>Leaflet.Illustrate</code> and <code>Leaflet.draw</code> objects will be stored in the MapKnitter database, and writing migrations and a new ActiveRecord model to handle them.</li>
<li>Adding to the <code>Leaflet.Illustrate</code> user interface to allow people to pick different colors, fonts, etc. for their annotations.</li>
</ul>
<p>I also <em>really</em> want to work on integrating Anish's ImageDistortLeaflet plugin into MapKnitter, since the ability to distort images placed on the map is absolutely the core functionality of MapKnitter.  This will be my primary focus as soon as I've spent some time working on annotations.</p>
</div>
</article>
